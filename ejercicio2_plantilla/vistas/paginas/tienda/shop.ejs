<section class="shop">
    <h1>Bienvenido a la Tienda</h1>

    <!-- Formulario para añadir un nuevo producto -->
    <div class="add-product-form">
        <h2>Añadir un nuevo producto</h2>
        <form action="/shop/add" method="POST" enctype="multipart/form-data">
            <label for="name">Nombre del producto:</label>
            <input type="text" id="name" name="name" required>

            <label for="description">Descripción:</label>
            <textarea id="description" name="description" required></textarea>

            <label for="price">Precio:</label>
            <input type="number" id="price" name="price" step="0.01" required>

            <label for="image">Imagen:</label>
            <input type="file" id="image" name="image" accept="image/*" required>

            <button type="submit">Añadir Producto</button>
        </form>
    </div>

    <!-- Si hay productos, los mostramos en tarjetas -->
    <% if (products && products.length > 0) { %>
        <h2>Productos disponibles</h2>
        <div class="product-list">
            <% products.forEach(product => { %>
                <div class="product-card">
                    <img src="<%= product.image %>" alt="Imagen de <%= product.name %>" width="200" height="200">
                    <h3><%= product.name %></h3>
                    <p><%= product.description %></p>
                    <p><strong>Precio:</strong> €<%= product.price.toFixed(2) %></p>
                    <p><strong>Estado:</strong>
                        <% if (product.status === 'P') { %>
                            En venta
                        <% } else { %>
                            Vendido
                        <% } %>
                    </p>

                    <div class="actions">
                        <!-- Botón para eliminar el producto -->
                        <form action="/shop/delete/<%= product.id %>" method="POST" onsubmit="return confirm('¿Seguro que deseas eliminar este producto?');">
                            <button type="submit">Eliminar</button>
                        </form>

                        <% if (product.status === 'P') { %>
                            <!-- Botón para marcar el producto como vendido -->
                            <form action="/shop/sell/<%= product.id %>" method="POST">
                                <button type="submit">Vender</button>
                            </form>
                        <% } else { %>
                            <button disabled>Ya vendido</button>
                        <% } %>
                    </div>
                </div>
            <% }); %>
        </div>
    <% } else { %>
        <p>No hay productos disponibles en este momento.</p>
    <% } %>
</section>